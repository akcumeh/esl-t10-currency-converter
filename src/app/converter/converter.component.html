<div class="converter-container">
  <form [formGroup]="converterForm" (ngSubmit)="onSubmit($event)" class="converter-form">
    
    <mat-form-field appearance="outline" class="amount-field">
      <mat-label>Amount</mat-label>
      <input 
        matInput 
        type="text" 
        formControlName="amount" 
        placeholder="Enter amount"
        (keydown.enter)="onConvert()"
      />
      <mat-error *ngIf="converterForm.get('amount')?.hasError('required')">
        Amount is required
      </mat-error>
      <mat-error *ngIf="converterForm.get('amount')?.hasError('pattern')">
        Please enter a valid number
      </mat-error>
    </mat-form-field>

    <div class="currency-row">
      <mat-form-field appearance="outline" class="currency-field">
        <mat-label>From</mat-label>
        <mat-select formControlName="fromCurrency">
          <mat-option *ngFor="let currency of currencies" [value]="currency.code">
            {{currency.code}} - {{currency.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="exchange-icon">
        <span class="material-symbols-outlined">swap_horiz</span>
      </div>

      <mat-form-field appearance="outline" class="currency-field">
        <mat-label>To</mat-label>
        <mat-select formControlName="toCurrency">
          <mat-option *ngFor="let currency of currencies" [value]="currency.code">
            {{currency.code}} - {{currency.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline" class="output-field">
      <mat-label>Converts To</mat-label>
      <input 
        matInput 
        type="text" 
        [value]="convertedValue" 
        readonly 
        disabled
        placeholder="0.00"
      />
      <div matSuffix *ngIf="loading$ | async" class="spinner-container">
        <mat-spinner diameter="20"></mat-spinner>
      </div>
    </mat-form-field>

    <button 
      mat-raised-button 
      color="primary" 
      type="submit"
      class="convert-button"
      [disabled]="!converterForm.valid || (loading$ | async) || converterForm.get('fromCurrency')?.value === converterForm.get('toCurrency')?.value"
    >
      <span *ngIf="!(loading$ | async)">Convert</span>
      <span *ngIf="loading$ | async">Loading rates...</span>
    </button>

    <!-- Error Message -->
    <div *ngIf="converterForm.get('fromCurrency')?.value === converterForm.get('toCurrency')?.value" class="error-message">
      Please select different currencies for conversion
    </div>

  </form>
</div>
